*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

body {
  width: 380px;
  background: #111;
  color: #f5f5f7;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
  font-size: 14px;
  -webkit-font-smoothing: antialiased;
}

/* ── Header ── */

.header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 18px 14px;
  border-bottom: 1px solid #1e1e1e;
}

.header-brand { display: flex; align-items: center; gap: 10px; }

.logo-img { width: 28px; height: 28px; border-radius: 7px; display: block; flex-shrink: 0; }

.brand-text { display: flex; flex-direction: column; gap: 1px; min-width: 0; }
.app-name { font-size: 15px; font-weight: 600; letter-spacing: -0.2px; line-height: 1.1; }
.app-tagline { font-size: 10px; color: #6f7685; line-height: 1.1; white-space: nowrap; }
.header-stats { font-size: 12px; color: #555; }

/* ── Shared layout ── */

.section-label {
  font-size: 11px; font-weight: 600; text-transform: uppercase;
  letter-spacing: 0.6px; color: #555; padding: 14px 18px 8px;
}

.divider { height: 1px; background: #1e1e1e; }

.empty-state { padding: 12px 18px 14px; font-size: 13px; color: #444; }

/* ── Site list ── */

#sitesList { max-height: 220px; overflow-y: auto; scrollbar-width: thin; scrollbar-color: #333 transparent; }

.site-item {
  display: flex; align-items: center; gap: 12px;
  padding: 10px 18px; border-bottom: 1px solid #1a1a1a;
  transition: background 0.15s;
}
.site-item:hover { background: #161616; }

.site-favicon { width: 20px; height: 20px; border-radius: 4px; flex-shrink: 0; background: #222; }

.site-info { flex: 1; min-width: 0; }

.site-host {
  font-size: 13px; font-weight: 500;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: #f5f5f7;
}

.site-meta { display: flex; align-items: center; gap: 8px; margin-top: 4px; flex-wrap: wrap; }

.badge {
  font-size: 10px; font-weight: 600; text-transform: uppercase;
  letter-spacing: 0.4px; padding: 2px 6px; border-radius: 4px; white-space: nowrap;
}
.badge-block    { background: #3a1a1a; color: #FF453A; }
.badge-limit    { background: #1a2a3a; color: #0A84FF; }
.badge-exceeded { background: #3a2a1a; color: #FF9F0A; }
.badge-pending  { background: #2a2a1a; color: #FF9F0A; }
.badge-sched-block { background: #3a1a2a; color: #FF375F; }
.badge-sched-allow { background: #1a3a2a; color: #30D158; }


.progress-wrap { flex: 1; display: flex; flex-direction: column; gap: 3px; }
.progress-bar  { height: 3px; background: #222; border-radius: 2px; overflow: hidden; }
.progress-fill { height: 100%; border-radius: 2px; transition: width 0.3s ease; }
.progress-text { font-size: 11px; color: #555; }

.remove-btn {
  background: none; border: none; color: #444; font-size: 18px; line-height: 1;
  cursor: pointer; padding: 2px 4px; border-radius: 4px; transition: color 0.15s, background 0.15s; flex-shrink: 0;
}
.remove-btn:hover { color: #FF453A; background: #2a1a1a; }

.cancel-pending-btn {
  background: none; border: 1px solid #333; color: #666; font-size: 11px;
  padding: 3px 8px; border-radius: 5px; cursor: pointer; font-family: inherit;
  transition: all 0.15s; white-space: nowrap;
}
.cancel-pending-btn:hover { border-color: #FF453A; color: #FF453A; }

/* ── Add section ── */

.add-section { padding: 0 18px 14px; display: flex; flex-direction: column; gap: 10px; }
.add-section .section-label { padding: 14px 0 0; }

.text-input {
  width: 100%; background: #1c1c1e; border: 1px solid #2a2a2a;
  border-radius: 8px; color: #f5f5f7; font-size: 14px; padding: 9px 12px;
  outline: none; transition: border-color 0.15s; font-family: inherit;
}
.text-input::placeholder { color: #444; }
.text-input:focus { border-color: #5856D6; }

.mode-toggle {
  display: flex; background: #1c1c1e; border-radius: 8px; padding: 3px; gap: 3px;
}
.mode-btn {
  flex: 1; padding: 7px 0; border: none; border-radius: 6px; background: transparent;
  color: #555; font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.15s; font-family: inherit;
}
.mode-btn.active { background: #2c2c2e; color: #f5f5f7; }

.limit-row { display: none; align-items: center; gap: 10px; }
.limit-row.visible { display: flex; }

.number-input {
  width: 80px; background: #1c1c1e; border: 1px solid #2a2a2a;
  border-radius: 8px; color: #f5f5f7; font-size: 14px; padding: 8px 10px;
  outline: none; transition: border-color 0.15s; font-family: inherit; text-align: center;
}
.number-input:focus { border-color: #5856D6; }

.limit-label { font-size: 13px; color: #555; }

.add-btn {
  width: 100%; padding: 10px; background: #5856D6; border: none; border-radius: 8px;
  color: #fff; font-size: 14px; font-weight: 600; cursor: pointer; transition: opacity 0.15s; font-family: inherit;
}
.add-btn:hover { opacity: 0.88; }
.add-btn:active { opacity: 0.75; }

.error-msg { font-size: 12px; color: #FF453A; min-height: 16px; text-align: center; }

/* ── Advanced button ── */

.advanced-btn {
  width: 100%; padding: 12px 18px; background: none; border: none;
  color: #555; font-size: 13px; cursor: pointer; text-align: left;
  font-family: inherit; transition: color 0.15s; border-top: 1px solid #1e1e1e;
}
.advanced-btn:hover { color: #888; }

/* ── Advanced view ── */

.back-btn {
  display: flex; align-items: center; gap: 6px;
  width: 100%; padding: 13px 18px; background: none; border: none;
  color: #5856D6; font-size: 13px; font-weight: 600; cursor: pointer;
  font-family: inherit; border-bottom: 1px solid #1e1e1e; transition: opacity 0.15s;
}
.back-btn:hover { opacity: 0.75; }

.adv-section { padding-bottom: 4px; }

.adv-description { font-size: 12px; color: #444; padding: 0 18px 10px; line-height: 1.5; }

.adv-input { margin: 0 18px 10px; width: calc(100% - 36px); }

.adv-input-row { padding: 0 18px 10px; }

.adv-action-btn {
  display: block; width: calc(100% - 36px); margin: 4px 18px 6px;
  padding: 9px; background: #1c1c1e; border: 1px solid #2a2a2a;
  border-radius: 8px; color: #f5f5f7; font-size: 13px; font-weight: 600;
  cursor: pointer; transition: opacity 0.15s; font-family: inherit;
}
.adv-action-btn:hover { opacity: 0.8; }
.adv-action-btn.green { background: #0d2018; border-color: #1a4028; color: #30D158; }

.adv-error { padding: 0 18px; }

/* ── Scheduled site item in main list ── */

.sched-time { font-size: 11px; color: #666; font-variant-numeric: tabular-nums; }

/* ── Scheduled rules in advanced ── */

.schedule-form { padding: 8px 0 0; display: flex; flex-direction: column; }

.schedule-item {
  display: flex; align-items: center; gap: 10px; padding: 9px 18px;
  border-bottom: 1px solid #1a1a1a; transition: background 0.15s;
}
.schedule-item:hover { background: #161616; }

.schedule-item-info { flex: 1; min-width: 0; }
.schedule-item-host { font-size: 13px; font-weight: 500; color: #f5f5f7; }
.schedule-item-detail { font-size: 11px; color: #555; margin-top: 2px; }

/* Time inputs */

.time-row { display: flex; gap: 12px; }

.time-field { display: flex; flex-direction: column; gap: 4px; flex: 1; }

.time-label { font-size: 11px; color: #555; font-weight: 500; }

.time-input {
  width: 100%; background: #1c1c1e; border: 1px solid #2a2a2a;
  border-radius: 8px; color: #f5f5f7; font-size: 14px; padding: 8px 10px;
  outline: none; transition: border-color 0.15s; font-family: inherit;
  color-scheme: dark;
}
.time-input:focus { border-color: #5856D6; }

/* ── Tunnel Vision card ── */

.tunnel-card {
  margin: 0 18px 10px; background: #0d2018; border: 1px solid #1a4028;
  border-radius: 10px; padding: 14px 16px; display: flex; flex-direction: column; gap: 10px;
}
.tunnel-card-top { display: flex; align-items: center; gap: 8px; }
.tunnel-status-dot {
  width: 7px; height: 7px; background: #30D158; border-radius: 50%; flex-shrink: 0;
  animation: pulse 2s infinite;
}
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
.tunnel-status-label { font-size: 12px; font-weight: 600; color: #30D158; text-transform: uppercase; letter-spacing: 0.5px; }
.tunnel-countdown { margin-left: auto; font-size: 13px; font-weight: 600; color: #f5f5f7; font-variant-numeric: tabular-nums; }
.tunnel-allowed { display: flex; align-items: center; gap: 8px; font-size: 13px; font-weight: 500; color: #f5f5f7; }
.tunnel-only-label {
  margin-left: auto; font-size: 11px; color: #30D158; background: #1a4028;
  padding: 2px 7px; border-radius: 4px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.4px;
}
.tunnel-end-btn {
  width: 100%; padding: 8px; background: none; border: 1px solid #1a4028;
  border-radius: 7px; color: #555; font-size: 12px; cursor: pointer; font-family: inherit; transition: all 0.15s;
}
.tunnel-end-btn:hover { border-color: #FF453A; color: #FF453A; }

/* ── Modals ── */

.modal-overlay {
  display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.75);
  z-index: 100; align-items: center; justify-content: center; padding: 16px;
}
.modal-overlay.open { display: flex; }

.modal {
  background: #1c1c1e; border-radius: 12px; padding: 20px; width: 100%;
  border: 1px solid #2a2a2a; display: flex; flex-direction: column; gap: 14px;
}

.modal-warning { font-size: 13px; font-weight: 600; color: #FF9F0A; }

.modal-prompt { font-size: 13px; color: #888; line-height: 1.5; }
.modal-prompt strong { color: #f5f5f7; font-family: monospace; font-size: 12px; background: #111; padding: 2px 5px; border-radius: 4px; }
.modal-warning,
.modal-prompt,
.modal-prompt strong {
  user-select: none;
  -webkit-user-select: none;
}

/* Extra separation between warning and prompt text in step 2 */
#modalStep2 .modal-warning + .modal-prompt {
  margin-top: 12px;
}

.modal-input {
  width: 100%; background: #111; border: 1px solid #333; border-radius: 8px;
  color: #f5f5f7; font-size: 13px; padding: 9px 12px; outline: none; font-family: inherit; transition: border-color 0.15s;
}
.modal-input:focus { border-color: #5856D6; }

.modal-hint { font-size: 11px; color: #FF453A; min-height: 14px; }

.modal-actions { display: flex; gap: 8px; justify-content: flex-end; }

.modal-cancel {
  background: none; border: 1px solid #333; color: #888; font-size: 13px;
  padding: 8px 16px; border-radius: 7px; cursor: pointer; font-family: inherit; transition: all 0.15s;
}
.modal-cancel:hover { border-color: #555; color: #f5f5f7; }

.modal-confirm {
  background: #5856D6; border: none; color: #fff; font-size: 13px; font-weight: 600;
  padding: 8px 16px; border-radius: 7px; cursor: pointer; font-family: inherit; transition: opacity 0.15s;
}
.modal-confirm:disabled { opacity: 0.3; cursor: default; }
.modal-confirm:not(:disabled):hover { opacity: 0.85; }

/* ── Compact advanced mode (popup has a hard browser height cap) ── */

body.advanced-mode .header {
  padding: 12px 18px 10px;
}

body.advanced-mode .back-btn {
  padding: 10px 18px;
}

body.advanced-mode .section-label {
  padding: 10px 18px 6px;
}

body.advanced-mode .adv-description {
  padding: 0 18px 8px;
  line-height: 1.35;
}

body.advanced-mode .adv-input {
  margin: 0 18px 8px;
}

body.advanced-mode .adv-input-row {
  padding: 0 18px 8px;
}

body.advanced-mode .adv-action-btn {
  margin: 2px 18px 4px;
  padding: 8px;
}

body.advanced-mode .schedule-item {
  padding: 7px 18px;
}

body.advanced-mode .schedule-form {
  padding-top: 4px;
}
